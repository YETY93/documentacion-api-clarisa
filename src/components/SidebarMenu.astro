---
// src/components/SidebarMenu.astro
import { getCollection } from 'astro:content';

const allDocs = await getCollection('docs');
const categories = [...new Set(allDocs.map(doc => doc.data.category))];
---
<nav class="h-full bg-white dark:bg-gray-950">
  <!-- Header del sidebar -->
  <div class="p-4 border-b border-gray-200 dark:border-gray-800">
    <h2 class="font-semibold text-gray-900 dark:text-white">Navegación</h2>
  </div>
  
  <!-- Contenido del sidebar -->
  <div class="p-4 overflow-y-auto h-[calc(100vh-140px)]">
    <ul class="space-y-6">
      {categories.map(category => (
        <li>
          <!-- Categoría -->
          <div class="flex items-center justify-between mb-2">
            <h3 class="font-medium text-gray-900 dark:text-white text-sm uppercase tracking-wide">
              {category}
            </h3>
            <span class="text-xs text-gray-500 bg-gray-100 dark:bg-gray-800 dark:text-gray-400 px-2 py-1 rounded">
              {allDocs.filter(doc => doc.data.category === category).length}
            </span>
          </div>
          
          <!-- Items de la categoría -->
          <ul class="space-y-1 border-l border-gray-200 dark:border-gray-700 ml-1 pl-3">
            {allDocs
              .filter(doc => doc.data.category === category)
              .map(doc => (
                <li>
                  <a 
                    href={`/${doc.data.category}/${doc.slug.split('/').pop()}`}
                    class="block text-sm text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-gray-50 dark:hover:bg-gray-800 px-2 py-1.5 rounded transition-colors"
                  >
                    {doc.data.title}
                  </a>
                </li>
              ))
            }
          </ul>
        </li>
      ))}
    </ul>
    
    <!-- Enlaces útiles -->
    <div class="mt-8 pt-6 border-t border-gray-200 dark:border-gray-700">
      <h3 class="font-medium text-gray-900 dark:text-white text-sm uppercase tracking-wide mb-3">
        Enlaces útiles
      </h3>
      <ul class="space-y-1">
        <li>
          <a href="/getting-started" class="block text-sm text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 px-2 py-1.5 rounded transition-colors">
            🚀 Comenzar
          </a>
        </li>
        <li>
          <a href="/authentication" class="block text-sm text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 px-2 py-1.5 rounded transition-colors">
            🔐 Autenticación
          </a>
        </li>
        <li>
          <a href="/examples" class="block text-sm text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 px-2 py-1.5 rounded transition-colors">
            📝 Ejemplos
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>