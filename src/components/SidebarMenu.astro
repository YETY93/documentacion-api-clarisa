---
// src/components/SidebarMenu.astro
import { getCollection } from 'astro:content';

const allDocs = await getCollection('docs');
const categories = [...new Set(allDocs.map(doc => doc.data.category))];
---
<nav class="bg-white dark:bg-slate-800 rounded-lg shadow-sm sticky top-6 h-fit">
  <div class="p-4 border-b border-gray-200 dark:border-gray-700">
    <h2 class="font-bold text-lg text-gray-900 dark:text-white">Navegación</h2>
  </div>
  
  <div class="p-4 max-h-[calc(100vh-200px)] overflow-y-auto">
    <ul class="space-y-3">
      {categories.map(category => (
        <li>
          <div class="flex items-center justify-between">
            <div class="font-semibold capitalize text-gray-800 dark:text-gray-200 text-sm uppercase tracking-wide">
              {category}
            </div>
            <span class="text-xs text-gray-500 bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded-full">
              {allDocs.filter(doc => doc.data.category === category).length}
            </span>
          </div>
          <ul class="ml-2 mt-2 space-y-1 border-l-2 border-gray-200 dark:border-gray-700 pl-3">
            {allDocs
              .filter(doc => doc.data.category === category)
              .map(doc => (
                <li class="sidebar-menu-item">
                  <a href={`/${doc.data.category}/${doc.slug.split('/').pop()}`} 
                     class="block text-sm text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 p-2 rounded transition-colors">
                     {doc.data.title}
                  </a>
                </li>
              ))}
          </ul>
        </li>
      ))}
    </ul>
    
    <!-- Enlaces adicionales -->
    <div class="mt-6 pt-4 border-t border-gray-200 dark:border-gray-700">
      <h3 class="font-semibold text-sm text-gray-800 dark:text-gray-200 uppercase tracking-wide mb-2">
        Enlaces útiles
      </h3>
      <ul class="space-y-1">
        <li>
          <a href="/getting-started" class="sidebar-menu-item block text-sm text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 p-2 rounded transition-colors">
            🚀 Comenzar
          </a>
        </li>
        <li>
          <a href="/authentication" class="sidebar-menu-item block text-sm text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 p-2 rounded transition-colors">
            🔐 Autenticación
          </a>
        </li>
        <li>
          <a href="/examples" class="sidebar-menu-item block text-sm text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 p-2 rounded transition-colors">
            📝 Ejemplos
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>