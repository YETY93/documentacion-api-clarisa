---
// src/pages/[category]/[slug].astro
import MainLayout from '../../layouts/MainLayout.astro';
import Breadcrumbs from '../../components/Breadcrumbs.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const pages = await getCollection('docs');
  return pages.map((page) => {
    const params = { category: page.data.category, slug: page.slug.split('/').pop() };
    const props = { page };
    return { params, props };
  });
}

const { page } = Astro.props;
const { Content } = await page.render();
---
<MainLayout title={page.data.title}>
  <!-- Breadcrumbs -->
  <Breadcrumbs category={page.data.category} title={page.data.title} />
  
  <!-- Contenido del documento -->
  <div class="prose prose-slate dark:prose-invert max-w-none">
    <!-- Header del documento -->
    <div class="not-prose mb-8 pb-6 border-b border-gray-200 dark:border-slate-700">
      <div class="flex items-center space-x-3 mb-4">
        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-clarisa-100 text-clarisa-800 dark:bg-clarisa-900/30 dark:text-clarisa-300">
          {page.data.category}
        </span>
        {page.data.method && (
          <span class={`inline-flex items-center px-2 py-1 rounded text-xs font-medium uppercase tracking-wide ${
            page.data.method === 'GET' ? 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300' :
            page.data.method === 'POST' ? 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300' :
            page.data.method === 'PUT' ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300' :
            page.data.method === 'DELETE' ? 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300' :
            'bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300'
          }`}>
            {page.data.method}
          </span>
        )}
      </div>
      <h1 class="text-3xl font-bold text-gray-900 dark:text-white mb-3">
        {page.data.title}
      </h1>
      {page.data.description && (
        <p class="text-lg text-gray-600 dark:text-gray-300">
          {page.data.description}
        </p>
      )}
      {page.data.endpoint && (
        <div class="mt-4 p-3 bg-gray-50 dark:bg-slate-800/50 rounded-lg border border-gray-200 dark:border-slate-700">
          <code class="text-sm font-mono text-gray-800 dark:text-gray-200">
            {page.data.method} {page.data.endpoint}
          </code>
        </div>
      )}
    </div>
    
    <!-- Contenido markdown -->
    <Content />
  </div>
</MainLayout>
--- 